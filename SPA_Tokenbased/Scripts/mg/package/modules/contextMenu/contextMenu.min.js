(function(n,t){t.module("ui.bootstrap.contextMenu",[]).service("CustomService",function(){"use strict";return{initialize:function(n){console.log("got here",n)}}}).constant("ContextMenuEvents",{ContextMenuAllClosed:"context-menu-all-closed",ContextMenuClosed:"context-menu-closed",ContextMenuOpening:"context-menu-opening",ContextMenuOpened:"context-menu-opened"}).directive("contextMenu",["$rootScope","ContextMenuEvents","$parse","$q","CustomService","$sce","$document","$window",function(i,r,u,f,e,o,s,h){function it(i){var c=i.$scope,u=i.item,v=i.event,y=i.modelValue,p=i.$promises,b=i.nestedMenu,k=i.$li,a=String(i.orientation).toLowerCase()==="left",s=null,r,e,o,h,l;return u.html?s=t.isFunction(u.html)?u.html(c):u.html:(r=n("<a>"),e={},a?(e.textAlign="right",e.paddingLeft="8px"):(e.textAlign="left",e.paddingRight="8px"),r.css(e),r.addClass("dropdown-item"),r.attr({tabindex:"-1",href:"#"}),o=u.text||u[0],h=w,typeof o=="string"?h=o:typeof o=="function"&&(h=o.call(c,c,v,y)),l=f.when(h),p.push(l),l.then(function(t){var u,i,f;b&&(i={fontFamily:"monospace",fontWeight:"bold"},a?(u="&lt;",i.float="left"):(u="&gt;",i.float="right"),f=n('<strong style="font-family:monospace;font-weight:bold;float:right;">'+u+"<\/strong>"),f.css(i),r.css("cursor","default"),r.append(f));r.append(t)}),s=r),k.append(s),s}function rt(n){var u=ft(n),e=w,i=t.extend({},n),r=n.item,f=r.enabled===undefined?r[2]:r.enabled;i.nestedMenu=u;i.enabled=v(f,n);i.text=it(i);ut(i)}function ut(i){var o=i.item,s=i.$ul,e=i.$li,r=i.$scope,h=i.modelValue,c=i.level,u=i.event,l=i.text,v=i.nestedMenu,b=i.enabled,p=String(i.orientation).toLowerCase(),d=i.customClass,w;if(b){w=function(n){y(c+1);var i={pageX:p==="left"?u.pageX-s[0].offsetWidth+1:u.pageX+s[0].offsetWidth-1,pageY:s[0].offsetTop+e[0].offsetTop-3,view:u.view||window,target:u.target,event:n};f.when(v).then(function(n){t.isFunction(n)&&(n=n.call(r,r,u,h,l,e));var f={$scope:r,event:i,options:n,modelValue:h,level:c+1,orientation:p,customClass:d};k(f)})};e.on("click",function(i){i.which==1&&(i.preventDefault(),r.$apply(function(){var f=function(){n(u.currentTarget).removeClass("context");a()},s=t.isFunction(o.click)?o.click:t.isFunction(o[1])?o[1]:null,i;s?(i=s.call(r,r,u,h,l,e),(i===undefined||i)&&f()):f()}))});e.on("mouseover",function(n){r.$apply(function(){v?w(n):y(c+1)})})}else tt(e)}function ft(n){var i=n.item;return i.children?t.isFunction(i.children)?i.children():t.isFunction(i.children.then)||t.isArray(i.children)?i.children:null:t.isArray(i[1])||i[1]&&t.isFunction(i[1].then)?i[1]:t.isArray(i[2])||i[2]&&t.isFunction(i[2].then)?i[2]:t.isArray(i[3])||i[3]&&t.isFunction(i[3].then)?i[3]:null}function k(u){var y=u.$scope,w=u.event,a=u.options,k=u.modelValue,d=u.level,g=u.customClass,f=ot(u),h,o;u.$ul=f;l.push(f);h=[];u.$promises=h;t.forEach(a,function(i){var s,o,r;i===null?p(f):(s=v(i.displayed,u),s&&(o=n("<li>"),r=t.extend({},u),r.item=i,r.$li=o,typeof i[0]=="object"?e.initialize(o,i):rt(r),v(i.hasTopDivider,r,!1)&&p(f),f.append(o),v(i.hasBottomDivider,r,!1)&&p(f)))});f.children().length===0&&(o=t.element("<li>"),tt(o),o.html("<a>"+b+"<\/a>"),f.append(o));s.find("body").append(f);et(u);i.$broadcast(r.ContextMenuOpened,{context:c,contextMenu:f,params:u})}function et(n){var r=n.$ul,e=n.$promises,u=n.level,i=n.event,o=String(n.orientation).toLowerCase()==="left";f.all(e).then(function(){var f=i.pageY,a=t.element(r[0]).prop("offsetHeight"),v=h.scrollY+i.view.innerHeight,y,c;f>a&&v-f<a+20?(f=i.pageY-a,u&&u>0&&(f+=i.event.currentTarget.offsetHeight)):v<=a?(t.element(r[0]).css({height:v-5,"overflow-y":"scroll"}),f=0):v-f<a&&(y=5,f<y&&(y=f),f=v-a-y);var n=i.pageX,e=t.element(r[0]).prop("offsetWidth"),l=i.view.innerWidth,s=5;o?l-n>e&&n<e+s?n=s:n<e?(c=5,l-n<c+s&&(c=l-n+s),n=e+c+s):n=n-e:n>e&&l-n-s<e?n=l-e-s:l-n<e&&(c=5,n<c+s&&(c=n+s),n=l-e-c-s);r.css({display:"block",position:"absolute",left:n+"px",top:f+"px"})})}function ot(t){var r=t.customClass,i=n("<ul>");return i.addClass("dropdown-menu"),i.attr({role:"menu"}),i.css({display:"block",position:"absolute",left:t.event.pageX+"px",top:t.event.pageY+"px","z-index":1e4}),r&&i.addClass(r),i}function st(){return"ontouchstart"in window||navigator.maxTouchPoints}function y(n){while(l.length&&(!n||l.length>n)){var t=l.pop();i.$broadcast(r.ContextMenuClosed,{context:c,contextMenu:t});t.remove()}n||i.$broadcast(r.ContextMenuAllClosed,{context:c})}function d(n){a(n)}function g(t){for(var i=n(t.target),r=!0;i.length;)if(i.hasClass("dropdown-menu")){r=!1;break}else i=i.parent();r&&a(t)}function a(){s.find("body").off("mousedown",g);s.off("scroll",d);n(c).removeClass("context");y();i.$broadcast("")}function nt(n){return n===!1||n===!0}function v(n,i,r){var o=i.item,u=i.$scope,f=i.event,e=i.modelValue;return r=nt(r)?r:!0,nt(n)?n:t.isFunction(n)?n.call(u,u,f,e):r}function p(n){var i=t.element("<li>");i.addClass("divider");n.append(i)}function tt(n){n.on("click",function(n){n.preventDefault()});n.addClass("disabled")}var l=[],c=null,w='"New Item',b="empty";return function(u,e,o){var h=["contextmenu"];b=u.$eval(o.contextMenuEmptyText)||"empty";o.contextMenuOn&&typeof o.contextMenuOn=="string"&&(h=o.contextMenuOn.split(","));t.forEach(h,function(h){e.on(h.trim(),function(h){if(o.allowEventPropagation||(h.stopPropagation(),h.preventDefault()),st()&&e.attr("draggable")==="true")return!1;s.find("body").on("mousedown",g);s.on("scroll",d);c=h.currentTarget;n(c).addClass("context");u.$apply(function(){var e=u.$eval(o.contextMenu),s=o.contextMenuClass,n=u.$eval(o.model),l=o.contextMenuOrientation;f.when(e).then(function(f){t.isFunction(f)&&(f=f.call(u,u,h,n));var e={$scope:u,event:h,options:f,modelValue:n,level:0,customClass:s,orientation:l};i.$broadcast(r.ContextMenuOpening,{context:c});k(e)})});u.$on("$destroy",function(){a()})})})}}])})(window.angular.element,window.angular);